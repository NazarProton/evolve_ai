import{j as t,a as s}from"./index-D3RqLDs3.js";import{C as E}from"./react-spline-D0xD6Du-.js";import{F as M}from"./FooterLinks-Dr3-1w2y.js";const L=({listening:e,startListening:c})=>t.jsxs("div",{className:"relative flex w-full flex-col items-center font-chivo-mono-light uppercase",children:[t.jsx("p",{className:"text-white mb-4 text-lg",children:e?"Listening":"Press to Talk"}),t.jsxs("button",{onClick:c,className:"relative flex items-center justify-center h-[48px] w-[48px] transition-opacity duration-300",children:[t.jsx("div",{className:"absolute inset-0 "}),t.jsx("img",{src:e?"/microOff.svg":"/microOn.svg",alt:e?"Microphone On":"Microphone Off",className:"w-12 h-12 opacity-25 transition-opacity duration-300 ease-out hover:opacity-100"})]})]}),k=({listening:e,startListening:c,circleSize:o})=>{const[f,a]=s.useState(.6666),d=s.useRef(!1);return s.useEffect(()=>{let m=.6666;const i=110;if(e){d.current||(a(.8333),d.current=!0);const l=o/i;l>.625&&l<1?m=o/i:o>1?m=1:m=.625,a(m)}else{m=.6666,a(.625),d.current=!1;const l=setTimeout(()=>a(.6666),300);return()=>clearTimeout(l)}},[o,e]),t.jsxs("div",{className:"relative w-full min-[384px]:w-[384px] h-[384px] flex justify-center items-center overflow-hidden",children:[t.jsx("div",{className:"relative w-full h-[384px]",children:t.jsx(E,{onClick:c,style:{position:"absolute",width:"100%",height:"100%",top:"50%",left:"50%",translate:"-50% -50%",transform:`scale(${f})`,transition:"transform 0.3s ease-out",cursor:"pointer"},scene:"https://prod.spline.design/moDxSU2YolLqofps/scene.splinecode"})}),t.jsx("div",{className:"absolute inset-0 bg-white opacity-0 transition-opacity duration-300 ease-out rounded-full"})]})},C=()=>{const[e,c]=s.useState(!1),[o,r]=s.useState(""),n=s.useRef(null),x=async()=>{if(e){u();return}const f=window.SpeechRecognition||window.webkitSpeechRecognition;if(!f){alert("Your browser does not support voice input  ðŸ˜ž");return}n.current=new f,n.current.lang="uk-UA",n.current.interimResults=!1,n.current.onstart=()=>{c(!0),r("")},n.current.onend=()=>{c(!1)},n.current.onresult=a=>{const d=a.results[0][0].transcript;r(d)},n.current.start()},u=()=>{n.current&&n.current.stop()};return{listening:e,recognizedText:o,startListening:x,stopListening:u}},T=e=>{const[c,o]=s.useState(20),r=s.useRef(null),n=s.useRef(null),x=s.useRef(null),u=s.useRef(null),f=s.useRef(!1),a=s.useRef(Date.now());s.useEffect(()=>{e?d():m()},[e]);const d=async()=>{try{if(r.current&&r.current.state!=="closed")return;const i=await navigator.mediaDevices.getUserMedia({audio:!0});u.current=i;const l=new AudioContext,h=l.createAnalyser(),w=l.createMediaStreamSource(i),y=l.createGain();w.connect(y),y.connect(h),h.fftSize=512;const S=h.frequencyBinCount,v=new Uint8Array(S);r.current=l,n.current=h,x.current=w,f.current=!0;const g=()=>{if(!f.current)return;const j=Date.now();if(j-a.current<50){requestAnimationFrame(g);return}h.getByteTimeDomainData(v);let b=0;for(let p=0;p<S;p++){const R=(v[p]-128)/128;b+=R*R}const A=Math.sqrt(b/S),N=Math.max(80,Math.min(250,80+A*600));o(p=>p+(N-p)*.8),a.current=j,requestAnimationFrame(g)};g()}catch(i){console.error("Microphone access error",i)}},m=()=>{f.current=!1,r.current&&r.current.state!=="closed"&&(r.current.close().catch(()=>{}),r.current=null),n.current=null,x.current=null,u.current&&(u.current.getTracks().forEach(i=>i.stop()),u.current=null)};return{circleSizeSpline:c}},I=({listening:e,AIMessage:c})=>{const[o,r]=s.useState(!0);return console.log(e),s.useEffect(()=>{e&&r(!1)},[e]),t.jsxs("div",{className:`flex justify-center items-center flex-col font-chivo-mono-light
         transition-opacity ease-out duration-300 ${o?"opacity-100":"opacity-0"}`,children:[t.jsx("div",{className:" bg-red text-white py-2 px-4 ",children:c}),t.jsx("div",{className:`w-0 h-0 border-l-8 border-red border-l-transparent \r
      border-r-8 border-r-transparent border-t-16 border-t-red-500 transform`})]})},z=()=>{const{listening:e,startListening:c}=C(),{circleSizeSpline:o}=T(e),r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),[n]=s.useState("Hello! My name is AISHA. How can I help you?");return t.jsxs("div",{className:"bg-black text-white w-full px-6 flex flex-col items-center",children:[t.jsxs("div",{className:`border w-full items-center justify-center border-white-25 flex flex-col max-w-[1280px] min-[1920px]:max-w-[66.6vw] ${r?"h-fit":"min-h-[596px] h-[calc(100vh-112px-112px)]"}`,children:[t.jsx(I,{listening:e,AIMessage:n}),t.jsx(k,{listening:e,startListening:c,circleSize:o}),t.jsx(L,{listening:e,startListening:c})]}),t.jsx(M,{})]})};export{z as default};
